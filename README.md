
# Discord Bot with Ollama AI Integration

This Discord bot allows users to ask questions using the `/ask` command and receive responses generated by the Ollama AI model. The bot sends the user's message to the AI and replies with the AI's response.

## Features

- **Command**: `/ask`
  - Description: Sends a message to the AI and returns the response.
  - Usage: `/ask <message>`
  
## Prerequisites

- Python 3.8 or higher
- Discord account and bot token
- Ollama API access and API key

## Setup

1. **Clone the repository:**

   ```sh
   git clone https://github.com/ItsHotdogFred/DiscordOllamaBot.git
   cd discord-bot-ollama
   ```

2. **Install the required Python packages:**

   ```sh
   pip install discord.py ollama
   ```

3. **Set up environment variables:**

   Create a `.env` file in the project directory and add your API keys:

   ```env
   DISCORD_BOT_TOKEN=your_discord_bot_token
   OLLAMA_API_KEY=your_ollama_api_key
   ```

   Or set them directly in your environment:

   ```sh
   export DISCORD_BOT_TOKEN=your_discord_bot_token
   export OLLAMA_API_KEY=your_ollama_api_key
   ```

## Usage

1. **Run the bot:**

   ```sh
   python bot.py
   ```

2. **Invite the bot to your Discord server:**

   Follow [this guide](https://discordpy.readthedocs.io/en/stable/discord.html) to invite the bot to your server using the OAuth2 URL generator.

3. **Use the `/ask` command:**

   In any channel where the bot has access, type:

   ```sh
   /ask Why is the sky blue?
   ```

   The bot will respond with the AI's answer to your question.

## Code Overview

The bot's main functionality is contained in the `bot.py` file:

```python
import discord
from discord import app_commands
import ollama
import os

# Initialize Discord client and command tree
intents = discord.Intents.default()
client = discord.Client(intents=intents)
tree = app_commands.CommandTree(client)

@tree.command(name="ask", description="Ask the AI a question and get a response")
@app_commands.describe(message="The message you want to send to the AI")
async def ask(interaction: discord.Interaction, message: str):
    try:
        # Send an immediate response to indicate processing
        await interaction.response.send_message("Processing your request...")

        # Send the message to the AI and get the response
        response = ollama.chat(model='llama3', messages=[{
            'role': 'user',
            'content': message,
        }])
        
        # Extract the content from the response
        ai_response = response['message']['content']

        # Fetch the original message to edit it
        original_message = await interaction.original_response()
        await original_message.edit(content=ai_response)

    except Exception as e:
        # Fetch the original message to edit it
        original_message = await interaction.original_response()
        await original_message.edit(content=f"An error occurred: {e}")

@client.event
async def on_ready():
    print(f'We have logged in as {client.user}')
    await tree.sync()

# Replace 'YOUR_BOT_TOKEN' with your actual bot token
client.run(os.environ.get('DISCORD_BOT_TOKEN'))
```

## Troubleshooting

- **Bot not responding to commands:**
  - Ensure the bot has the necessary permissions in the Discord server.
  - Check that the bot is running and connected to the internet.
  - Verify that the bot token and API key are correctly set in your environment.

## Contributing

Feel free to open issues or submit pull requests if you find bugs or want to add features.

## License

This project is licensed under the MIT License.

---
